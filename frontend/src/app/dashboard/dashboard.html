<div class="dashboard" #dashboardContainer>

  <!-- =========================
       DISTRIBUI√á√ÉO DOS GASTOS
  ========================== -->
  <div class="section-block">
    <div class="section-highlight">
      Distribui√ß√£o dos gastos
    </div>

    <div class="chart-pair">
      <!-- Categoria m√™s -->
      <div class="chart-card">
        <h3 class="chart-title">Gastos por categoria (m√™s atual)</h3>

        <ng-container *ngIf="series.length && labels.length; else emptyCurrent">
          <apx-chart [series]="series" [chart]="chart" [labels]="labels" [legend]="legend" [theme]="theme">
          </apx-chart>
        </ng-container>

        <ng-template #emptyCurrent>
          <div class="empty-state">Nenhum gasto registrado neste m√™s</div>
        </ng-template>
      </div>

      <!-- Categoria total -->
      <div class="chart-card">
        <h3 class="chart-title">Gastos por categoria (total)</h3>

        <ng-container *ngIf="totalSeries.length && totalLabels.length; else emptyTotal">
          <apx-chart [series]="totalSeries" [chart]="chart" [labels]="totalLabels" [legend]="legend" [theme]="theme">
          </apx-chart>
        </ng-container>

        <ng-template #emptyTotal>
          <div class="empty-state">Nenhum gasto registrado at√© o momento</div>
        </ng-template>
      </div>
    </div>

    <!-- Subcategoria -->
    <div class="chart-card chart-wide">
      <h3 class="chart-title">Gastos por subcategoria (total)</h3>

      <apx-chart *ngIf="subcategorySeries.length && subcategoryXAxis.categories.length" [series]="subcategorySeries" [chart]="subcategoryChart"
        [xaxis]="subcategoryXAxis" [plotOptions]="subcategoryPlotOptions" [theme]="theme">
      </apx-chart>

      <div *ngIf="!subcategorySeries.length" class="empty-state">
        Nenhum gasto registrado
      </div>
    </div>
  </div>

  <!-- =========================
       EVOLU√á√ÉO HIST√ìRICA
  ========================== -->
  <div class="section-block">
    <div class="section-highlight">
      Evolu√ß√£o dos gastos
    </div>

    <div class="chart-card chart-wide">
      <h3 class="chart-title">Evolu√ß√£o mensal de gastos</h3>

      <apx-chart *ngIf="monthlySeries.length && monthlyXAxis.categories.length" [series]="monthlySeries" [chart]="monthlyChart" [xaxis]="monthlyXAxis"
        [stroke]="monthlyStroke" [theme]="theme">
      </apx-chart>

      <div *ngIf="!monthlySeries.length" class="empty-state">
        Nenhum dado de evolu√ß√£o dispon√≠vel
      </div>
    </div>
  </div>

  <!-- =========================
       SITUA√á√ÉO DO M√äS
  ========================== -->
  <div class="section-block">
    <div class="section-highlight">
      Situa√ß√£o do m√™s
    </div>

    <!-- ALERTAS -->
    <div class="alerts-wrapper" *ngIf="alerts">

      <div class="alert-card danger" *ngIf="alerts.salary_percentage >= 70">
        üî¥ Voc√™ j√° comprometeu
        <strong>{{ alerts.salary_percentage }}%</strong>
        do seu sal√°rio neste m√™s
      </div>

      <div class="alert-card warning" *ngIf="alerts.salary_percentage >= 50 && alerts.salary_percentage < 70">
        ‚ö†Ô∏è Voc√™ j√° comprometeu
        <strong>{{ alerts.salary_percentage }}%</strong>
        do seu sal√°rio neste m√™s
      </div>

      <div class="alert-card info" *ngIf="alerts.due_soon?.length">
        üìå {{ alerts.due_soon.length }}
        parcela(s) vencem nos pr√≥ximos 7 dias
      </div>
    </div>

    <!-- METAS -->
    <div class="goals-wrapper">

      <div class="goal-card" *ngIf="salaryGoal">
        <h4>Meta pelo sal√°rio l√≠quido</h4>

        <div class="goal-bar">
          <div class="goal-progress" [class.warning]="salaryGoal.percentage >= 70"
            [class.danger]="salaryGoal.percentage >= 90" [style.width.%]="salaryGoal.percentage">
          </div>
        </div>

        <small>
          R$ {{ salaryGoal.used }} /
          R$ {{ salaryGoal.limit }}
          ({{ salaryGoal.percentage }}%)
        </small>
      </div>

      <div class="goal-card" *ngIf="limitGoal">
        <h4>Meta pelo limite sugerido</h4>

        <div class="goal-bar">
          <div class="goal-progress" [class.warning]="limitGoal.percentage >= 70"
            [class.danger]="limitGoal.percentage >= 90" [style.width.%]="limitGoal.percentage">
          </div>
        </div>

        <small>
          R$ {{ limitGoal.used }} /
          R$ {{ limitGoal.limit }}
          ({{ limitGoal.percentage }}%)
        </small>
      </div>

    </div>

    <div class="chart-card chart-wide">
      <h3 class="chart-title">Parcelas que vencem: m√™s atual x anterior</h3>

      <apx-chart *ngIf="comparisonSeries.length && comparisonXAxis.categories.length" [series]="comparisonSeries" [chart]="comparisonChart"
        [xaxis]="comparisonXAxis" [plotOptions]="comparisonPlotOptions" [theme]="theme">
      </apx-chart>

      <div *ngIf="!comparisonSeries.length" class="empty-state">
        Sem dados para compara√ß√£o
      </div>
    </div>

    <div class="chart-card chart-wide">
      <h3 class="chart-title">Gasto real por m√™s (parcelas + fixos)</h3>

      <div class="chart-scroll">
        <apx-chart *ngIf="monthlyPurchasesSeries.length && monthlyRealXAxis.categories.length" [series]="monthlyPurchasesSeries" [chart]="monthlyRealChart"
          [xaxis]="monthlyRealXAxis" [plotOptions]="monthlyRealPlotOptions" [dataLabels]="dataLabels"
          [responsive]="monthlyRealResponsive" [theme]="theme">
        </apx-chart>
      </div>

      <div *ngIf="!monthlyPurchasesSeries.length" class="empty-state">
        Nenhum dado dispon√≠vel
      </div>
    </div>
  </div>

  <!-- =========================
       PLANEJAMENTO FUTURO
  ========================== -->
  <div class="section-block">
    <div class="section-highlight">
      Planejamento futuro
    </div>

    <div class="chart-card chart-wide">
      <h3 class="chart-title">
        Planejamento futuro de gastos (parcelas + fixos)
      </h3>

      <apx-chart *ngIf="futurePlanningSeries.length && futurePlanningXAxis.categories.length" [series]="futurePlanningSeries" [chart]="futurePlanningChart"
        [xaxis]="futurePlanningXAxis" [stroke]="futurePlanningStroke" [theme]="theme">
      </apx-chart>

      <div *ngIf="!futurePlanningSeries.length" class="empty-state">
        Nenhum planejamento futuro dispon√≠vel
      </div>
    </div>
  </div>

  <!-- =========================
       RESUMO FINANCEIRO
  ========================== -->
  <div class="section-block">
    <div class="section-highlight">
      Resumo financeiro do m√™s
    </div>

    <div class="chart-pair">

      <div class="chart-card">
        <h3 class="chart-title">Terceiros x Gasto total</h3>

        <apx-chart *ngIf="thirdPartyData && thirdPartyGaugeSeries.length" [series]="thirdPartyGaugeSeries" [chart]="thirdPartyGaugeChart"
          [plotOptions]="thirdPartyGaugeOptions.plotOptions" [fill]="thirdPartyGaugeOptions.fill">
        </apx-chart>

        <div class="gauge-footer" *ngIf="thirdPartyData">
          <div>
            <span>Terceiros</span>
            <strong>R$ {{ thirdPartyData.third_party.value }}</strong>
          </div>

          <div>
            <span>Total do m√™s</span>
            <strong>R$ {{ thirdPartyData.total }}</strong>
          </div>
        </div>
      </div>

      <div class="chart-card">
        <h3 class="chart-title">Meu gasto real</h3>

        <apx-chart *ngIf="thirdPartyData" [series]="myRealGaugeSeries" [chart]="thirdPartyGaugeChart"
          [plotOptions]="thirdPartyGaugeOptions.plotOptions" [fill]="{ colors: ['#22c55e'] }">
        </apx-chart>

        <div class="gauge-footer" *ngIf="thirdPartyData">
          <div>
            <span>Meu gasto</span>
            <strong>R$ {{ thirdPartyData.my_real.value }}</strong>
          </div>

          <div>
            <span>Total do m√™s</span>
            <strong>R$ {{ thirdPartyData.total }}</strong>
          </div>
        </div>
      </div>

    </div>
  </div>

</div>